# Phonix Web (apps/web)

Mobile-first UI to explore American English phonemes with audio and simple, approachable design.

## Features

- Consonant chart: table (manner rows × place columns) with dotted‑underline header tooltips (place/manner micro‑help)
- Vowels: temporary grouped list (height) until interactive vowel chart arrives
- Phoneme dialogs: symbol, articulation tags, guide, examples with audio, pedagogically relevant allophones
- Audio: quick playback for example words (one clip per word)
- Dark mode: light/dark/system theme preference persisted
- Routing: TanStack Router (`/` landing placeholder, `/ipa-chart` exploration)

## Tech Stack

- Vite + React + TypeScript
- Tailwind CSS v4 (via `@tailwindcss/vite`) with dark variant scoped to `.dark`
- shadcn/ui components (Radix UI primitives)
- Data from `packages/shared-data` (consonants, vowels, helpers)

## App Structure

-- `src/components/chart/ConsonantChart.tsx`
  - Table layout; imports `ConsonantCell`, `ConsonantDialog`, `ArticulationInfoPopover`
  - Memoized grid generation (`useConsonantGrid`) prevents redundant filtering
  - Dialog: hero symbol + tags + guide + examples + allophones
  - Micro‑help: header tooltip popovers (short definitions, examples)
- `src/components/chart/VowelChart.tsx`
  - Cards-only view grouped by height (temporary)
  - Dialog shows: header, Articulation, Examples (with audio)
- `src/components/phoneme/PhonemeTile.tsx` and `src/components/phoneme/VowelTile.tsx`
  - Symbol button + quick AudioButton for the first example
- `src/components/audio/AudioButton.tsx`
  - Accessible audio playback (HTMLAudioElement)
- `src/components/theme-provider.tsx`
  - Applies `light`/`dark` or follows `system` by toggling the `html` class; persists under `phonix-ui-theme`
- `src/routes/__root.tsx`
  - Root layout (header, theme provider, devtools) and `<Outlet />`
- `src/routes/index.tsx`
  - Placeholder home (future phonemic transcription tool)
- `src/routes/ipa-chart.tsx`
  - IPA chart page with tabs (consonants / vowels) — to be replaced by URL-driven section parameter in a future iteration
- `src/routeTree.gen.ts`
  - Auto-generated by TanStack Router plugin; do not edit manually
- `src/routes/main.tsx`
  - Bootstraps the router (imports `routeTree`, registers router, renders `RouterProvider`)

## Data & Audio

- Import from `shared-data`:
  - `consonants`, `vowels`
  - `phonixUtils`: `toPhonemic(ipa)`, `getExampleAudioUrl(word)`
- Example audio files are served from `/audio/examples/<slug>.mp3`
  - Generate with `packages/tts-generate` (optional), or provide your own files in `public/audio/examples/`

## Development

From repository root:

```sh
pnpm install
pnpm -C apps/web dev
```

### Routing Dev

File-based routes are defined under `src/routes`. The plugin generates `routeTree.gen.ts` which is imported by `src/routes/main.tsx` to create the router instance. Add a new page by creating `src/routes/<name>.tsx` using `createFileRoute("/<path>")` and the generator will rebuild the tree.

Current routes:

- `/` – placeholder landing (future transcription UI)
- `/ipa-chart` – IPA exploration (internal tab state still local; will migrate to search params like `?section=vowels`)

Devtools: TanStack Router devtools are enabled in the root layout (`<TanStackRouterDevtools />`). They can be removed or gated later.

Build and preview:

```sh
pnpm -C apps/web build
pnpm -C apps/web preview
```

Typecheck & lint:

```sh
pnpm -C apps/web typecheck
pnpm -C apps/web lint
```

## Theming

- Default: `system` (matches OS)
- Toggle persists to `localStorage` (`phonix-ui-theme`)
- Tailwind dark styles use `.dark` class; tokens defined in CSS variables

## Accessibility

- Buttons have labels for screen readers
- Dialogs and tooltips come from Radix primitives (focus management, ARIA)
- Audio controls are keyboard accessible

## Roadmap (UI)

- Interactive vowel trapezoid (responsive, hover/tap reveal)
- Illustration assets for consonant place/manner (dialog + tooltips)
- Minimal pairs + spelling patterns panel
- URL search param for section + deep link to open symbol dialog
- Progressive enhancement: optional side reference panel (articulation guide)

## Troubleshooting

- No audio: ensure files exist under `apps/web/public/audio/examples/` with slugs matching `getExampleAudioUrl(word)`
- Styles missing: verify Tailwind v4 plugin is active and CSS imports in `src/index.css`
- Dark mode not changing: confirm `html` has `dark` class when toggled and `ThemeProvider` wraps `App`
